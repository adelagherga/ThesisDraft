%% The following is a directive for TeXShop to indicate the main file
%%!TEX root = diss.tex

\chapter{Preliminaries}
\label{ch:Preliminaries}

\begin{enumerate}
\item algebraic number theory background [edited once] \autoref{sec:AlgebraicNumberTheory}.
\item $p$-adics valuations [edited once] \autoref{sec:pAdicValuations}
\item $p$-adic logs [edited once] \autoref{sec:pAdicLogarithms}
\item Weil height [edited once] \autoref{sec:WeilHeight}
\item Elliptic curves [DONE - rough]
\end{enumerate}

%--------------------------------------------------------------------------------------------------------------------------------------------%
%--------------------------------------------------------------------------------------------------------------------------------------------%

\section{Algebraic number theory} 
\label{sec:AlgebraicNumberTheory}

\edit{Add some better intro: maybe see masters thesis}\\
\edit{In this section we recall some basic results from algebraic number theory that we use throughout the remaining chapters. We refer to \edit{Marcus} and \edit{Neukirch} for full details. Establish notation. The background for the material presented in this chapter is taken primarily from \edit{Marcus} and \edit{Neukirch}, and the material presented in \edit{}Section 2.2 can be found in [5]}

Let $K$ be a finite algebraic extension of $\mathbb{Q}$ of degree $n = [K:\mathbb{Q}]$. There are $n$ embeddings $\sigma: K \to \mathbb{C}$. These embeddings can be described by writing $K = \mathbb{Q}(\theta)$ for some $\theta \in \mathbb{C}$ and observing that $\theta$ can be sent to any one of its conjugates. 
Let $s$ denote the number of real embeddings of $K$ and let $t$ denote the number of conjugate pairs of complex embeddings of $K$, where $n = s + 2t$. By Dirichlet's Unit Theorem, the group of units of $K$ is the direct product of a finite cyclic group consisting of the roots of unity in $K$ and a free abelian group of rank $r = s + t -1$. Equivalently, there exists a system of $r$ independent units $\eps_1, \dots, \eps_r$ such that the group of units of $K$ is given by 
\[\left\{\zeta \cdot \eps_1^{a_1}\cdots \eps_r^{a_r} \ : \ \zeta \text{ a root of unity}, a_i \in \mathbb{Z} \text{ for } i = 1, \dots, r\right\}.\]
Any set of independent units that generate the torsion-free part of the unit group is called a system of \textit{fundamental units}. 

An element $\alpha \in K$ is called an \textit{algebraic integer} if its minimal polynomial over $\mathbb{Z}$ is monic. The set of algebraic integers in $K$ forms a ring, denoted $\mathcal{O}_K$. We refer to this ring as the \textit{ring of integers} or \textit{number ring} corresponding to the number field $K$. For any $\alpha \in K$, we define the \textit{norm} of $\alpha$ as 
\[N_{K/\mathbb{Q}}(\alpha) = \prod_{\sigma:K \to \mathbb{C}} \sigma(\alpha)\]
where the product is taken over all embeddings $\sigma$ of $K$. For algebraic integers, $N_{K/\mathbb{Q}}(\alpha) \in \mathbb{Z}$. The units are precisely the elements of norm $\pm 1$. Two elements $\alpha, \beta$ of $K$ are called \textit{associates} if there exists a unit $\eps$ such that $\alpha = \eps \beta$. Let $(\alpha)\mathcal{O}_K$ denote the ideal generated by $\alpha$. Associated elements generate the same ideal, and distinct generators of an ideal are associated. There exist only finitely many non-associated algebraic integers in $K$ with given norm. 

Any element of the ring of integers can be written as a product of \textit{irreducible} elements. These are non-zero non-unit elements of $\mathcal{O}_K$ which have no integral divisors but their own associates. Unfortunately, number rings are not alway unique factorization domains: this decomposition into irreducible elements may not be unique. However, every number ring is a Dedekind domain. This means that every ideal can be decomposed into a product of prime ideals and this decomposition is unique. A \textit{principal} ideal is an ideal generated by a single element $\alpha$. Two fractional ideals are called equivalent if their quotient is principal. It is well known that there are only finitely many equivalence classes of fractional ideals and the set of all such classes forms a finite abelian group called the \textit{ideal class group}, $\Cl(K)$. The number of ideal classes, $\#\Cl(K)$, is called the \textit{class number} of $\mathcal{O}_K$ and is denoted by $h_K$. For an ideal $\mathfrak{a}$, it is always true that $\mathfrak{a}^{h_K}$ is principal. The norm of the (integral) ideal $\mathfrak{a}$ is defined by $N_{K/\mathbb{Q}}(\mathfrak{a}) = \#\left(\mathcal{O}_K/\mathfrak{a}\right)$. If $\mathfrak{a} = (\alpha) \mathcal{O}_K$ is a principal ideal, then $N_{K/\mathbb{Q}}(\mathfrak{a}) = \left|N_{K/\mathbb{Q}}(\alpha)\right|$. 

Let $L$ be a finite field extension of $K$ with ring of integers $\mathcal{O}_L$. Every prime ideal $\mathfrak{P}$ of $\mathcal{O}_L$ \textit{lies over} a unique prime ideal $\mathfrak{p}$ in $\mathcal{O}_K$. That is, $\mathfrak{P}$ divides $\mathfrak{p}$. The \textit{ramification index} $e({\mathfrak{P}}|\mathfrak{p})$ is the largest power to which $\mathfrak{P}$ divides $\mathfrak{p}$. The field $\mathcal{O}_L/\mathfrak{P}$ is an extension of finite degree $f(\mathfrak{P}|\mathfrak{p})$ over $\mathcal{O}_K/\mathfrak{p}$. We call $f(\mathfrak{P}|\mathfrak{p})$ the \textit{inertial degree} of $\mathfrak{P}$ over $\mathfrak{p}$. For $\mathfrak{p}$ lying over the rational prime $p$, this is the integer such that 
\[N_{K/\mathbb{Q}}(\mathfrak{p}) = p^{f(\mathfrak{p}|p)}.\]
The ramification index and inertial degree are multiplicative in a tower of fields. In particular, if $\mathfrak{P}$ lies over $\mathfrak{p}$ which lies over the rational prime $p$, then
\[e({\mathfrak{P}}|p) = e({\mathfrak{P}}|\mathfrak{p})e({\mathfrak{p}}|p) \quad \text{ and } \quad f({\mathfrak{P}}|p) = f({\mathfrak{P}}|\mathfrak{p})f({\mathfrak{p}}|p).\]
Let $\mathfrak{P}_1, \dots, \mathfrak{P}_m$ be the primes of $\mathcal{O}_L$ lying over a prime ideal $\mathfrak{p}$ of $\mathcal{O}_K$. Denote by $e({\mathfrak{P}}_1|\mathfrak{p}),\dots, e({\mathfrak{P}}_m|\mathfrak{p})$ and $f({\mathfrak{P}}_1|\mathfrak{p}), \dots, f({\mathfrak{P}}_m|\mathfrak{p})$ the corresponding ramification indices and inertial degrees. Then
\[\sum_{i=1}^m e({\mathfrak{P}}_i|\mathfrak{p})f({\mathfrak{P}}_i|\mathfrak{p}) = [L:K].\]

If $L$ is normal over $K$ and $\mathfrak{P}_i$ and $\mathfrak{P}_j$ are two prime ideals lying over $\mathfrak{p}$, then $e({\mathfrak{P}}_i|\mathfrak{p}) = e({\mathfrak{P}}_j|\mathfrak{p})$ and $f({\mathfrak{P}}_i|\mathfrak{p}) = f({\mathfrak{P}}_j|\mathfrak{p})$. In this case, $\mathfrak{p}$ factors as
\[\mathfrak{p}\mathcal{O}_L = \left( \mathfrak{P}_1 \cdots \mathfrak{P}_m\right)^e\]
in $\mathcal{O}_L$, where the $\mathfrak{P}_i$ are distinct prime ideals all having the same ramification degree $e$ and inertial degree $f$ over $\mathfrak{p}$. It follows that 
\[mef = [L:K].\]

%--------------------------------------------------------------------------------------------------------------------------------------------%
%--------------------------------------------------------------------------------------------------------------------------------------------%

\section{$p$-adic valuations}
\label{sec:pAdicValuations}

\edit{fix intro:
In this section we give a concise exposition of $p$-adic valuations. 
Everything in this document is based off of ``Elementary and analytic theory of algebraic numbers'' by W. Narkiewicz.
Throughout this thesis, we denote the algebraic closure of $\mathbb{Q}_p$ by $\overline{\mathbb{Q}}_p$. The completion of $\overline{\mathbb{Q}}_p$ with respect to the absolute value of $\overline{\mathbb{Q}}_p$ is denoted by $\mathbb{C}_p$.}

Let $K$ be an arbitrary number field. A homomorphism $v: K^* \to \mathbb{R}_{\geq 0}$ of the multiplicative group of $K$ into the group of positive real numbers is called a \textit{valuation} if it satisfies the condition
\[v(x+y) \leq v(x) + v(y).\]
This definition may be extended to all of $K$ by setting $v(0) = 0$. If
\[v(x+y) \leq \max(v(x),v(y))\]
holds for all $x,y \in K$, then $v$ is called a \textit{non-Archimedean valuation}. All remaining valuations on $K$ are called \textit{Archimedean}. 

Every valuation $v$ induces on $K$ the structure of a metric topological space which may or may not be complete. We say that two valuations are \textit{equivalent} if they define the same topology and we call an equivalence class of absolute values a \textit{place} of $K$. It is an elementary result of topology that every metric space may be embedded in a complete metric space, and this can be done in an essentially unique way. For the field $K$, the resulting complete metric space may be given a field structure. Equivalently, there exists a field $L$ with a valuation $w$ such that $L$ is complete in the topology induced by $w$. The field $K$ is contained in $L$ and the valuations $v$ and $w$ coincide in $K$. Moreover, the completion $L$ of $K$ is unique up to topological isomorphism.

For any non-zero prime ideal $\mathfrak{p}$ of $\mathcal{O}_K$, let $\ord_{\mathfrak{p}}(\mathfrak{a})$ denote the exact power to which $\mathfrak{p}$ divides the ideal $\mathfrak{a}$. For fractional ideals $\mathfrak{a}$ this number may be negative. For $\alpha \in K$, we write $\ord_{\mathfrak{p}}(\alpha)$ for $\ord_{\mathfrak{p}}\left((\alpha)\mathcal{O}_K\right)$. Every prime ideal defines a discrete non-Archimedean valuation on $K$ via
\[v(x):= \left(\frac{1}{N_{K/\mathbb{Q}}(\mathfrak{p})}\right)^{\ord_{\mathfrak{p}}(x)}.\]
Furthermore, every embedding of $K$ into the complex field defines an Archimedean valuation. Conversely, every discrete valuation on $K$ arises in this way by a prime ideal of $\mathcal{O}_K$, while every Archimedean valuation of $K$ is equivalent to $|\sigma(x)|$, where $\sigma$ is an embedding of $K$ into $\mathbb{C}$. Valuations defined by different prime ideals are non-equivalent, and two valuations defined by different embeddings of $K$ into $\mathbb{C}$ are equivalent if and only if those embeddings are complex conjugated. The topology induced in $K$ by a prime ideal $\mathfrak{p}$ of $\mathcal{O}_K$ is called the \textit{$\mathfrak{p}$-adic topology}. The completion of $K$ under this valuation is denoted by $K_{\mathfrak{p}}$ or $K_v$ and called the \textit{$\mathfrak{p}$-adic field}. Let $V$ be the set of all valuations of an algebraic number field $K$. Then for every non-zero element $\alpha \in K$ we have 
\[\prod_{v \in V} v(\alpha) = 1.\]

In the ring of integers of $\mathbb{Q}$, the prime ideals are generated by the rational primes $p$, and the resulting topology in the field $\mathbb{Q}$ is called the \textit{$p$-adic topology}. The completion of $\mathbb{Q}$ under this valuation is denoted by $\mathbb{Q}_p$. If $v(x)$ is a non-trivial valuation of $\mathbb{Q}$, then either $v(x)$ is equivalent to the ordinary absolute value $|x|$, or it is equivalent to one of the $p$-adic valuations induced by rational primes. Analogous to $\ord_{\mathfrak{p}}$, for any prime $p$ we define the $p$-adic order of $x \in \mathbb{Q}$ as the largest exponent of $p$ dividing $x$. Then, the $p$-adic valuation $v$ is defined as
\[v(x) = p^{-\ord_p(x)}.\]
If $K_{\mathfrak{p}}$ is a $\mathfrak{p}$-adic field, it is necessarily a finite extension of a certain $\mathbb{Q}_p$. 

Consider now $K/\mathbb{Q}$ where $n = [K:\mathbb{Q}]$ and let $g(t)$ denote the minimal polynomial of $K$ over $\mathbb{Q}$. Suppose $p$ is a rational prime and let $g(t) = g_1(t) \cdots g_m(t)$ be the decomposition of $g(t)$ into irreducible polynomials $g_i(t) \in \mathbb{Q}_p[t]$ of degree $n_i = \deg g_i(t)$. The prime ideals in $K$ dividing $p$ are in one-to-one correspondence with $g_1(t), \dots, g_m(t)$. More precisely, we have in $K$ the following decomposition of $(p)\mathcal{O}_K$
\[(p)\mathcal{O}_K = \mathfrak{p}_1^{e(\mathfrak{p}_1|p)} \cdots \mathfrak{p}_m^{e(\mathfrak{p}_m|p)},\]
with $\mathfrak{p}_1, \dots, \mathfrak{p}_m$ distinct prime ideals and ramification indices $e(\mathfrak{p}_1 | p), \dots, e(\mathfrak{p}_m | p) \in \mathbb{N}$. For $i = 1, \dots, m$ the inertial degree of $\mathfrak{p}_i$ is denoted by $f(\mathfrak{p}_i|p)$. Then $n_i = e(\mathfrak{p}_i | p)f(\mathfrak{p}_i | p)$ and $K_{\mathfrak{p}_i} \simeq \mathbb{Q}_p(\theta_i)$, where $g(\theta_i) = 0$. 

By $\overline{\mathbb{Q}_p}$ we denote the algebraic closure of $\mathbb{Q}_p$. There are $n$ embeddings of $K$ into $\overline{\mathbb{Q}_p}$, and each one fixes $\mathbb{Q}$ and maps $\theta$ to a root of $g$ in $\overline{\mathbb{Q}_p}$. Let $\theta_i^{(1)}, \dots, \theta_i^{(n_i)}$ denote the roots of $g_i(t)$ in $\overline{\mathbb{Q}_p}$. For $i = 1, \dots, m$ and $j = 1, \dots, n_i$, let $\sigma_{ij}$ be the embedding of $K$ into $\mathbb{Q}_p(\theta_i^{(j)})$ defined by $\theta \mapsto \theta_i^{(j)}$. The $m$ classes of conjugate embeddings are $\{\sigma_{i1}, \dots, \sigma_{in_i}\}$ for $i = 1, \dots, m$. Note that $\sigma_{ij}$ coincides with the embedding $K \hookrightarrow K_{\mathfrak{p}_i} \simeq \mathbb{Q}_p(\theta_i) \simeq \mathbb{Q}_p(\theta_i^{(j)})$. 

For any finite extension $L$ of $\mathbb{Q}_p$, the $p$-adic valuation $v$ of $\mathbb{Q}_p$ extends uniquely to $L$ as 
\[v(x) = |N_{L/\mathbb{Q}_p}(x)|^{1/[L:\mathbb{Q}_p]}.\]
Here, we define the $p$-adic order of $x \in L$ by
\[\ord_p(x) = \frac{1}{[L:\mathbb{Q}_p]}\ord_p(N_{L/\mathbb{Q}_p}(x)).\]
This definition is independent of the field $L$ containing $x$. So, since each element of $\overline{\mathbb{Q}_p}$ is by definition contained in some finite extension of $\mathbb{Q}_p$, this definition can be used to define the $p$-adic valuation $v$ of any $x \in \overline{\mathbb{Q}_p}$. Every finite extension of $\mathbb{Q}_p$ is complete with respect to $v$, but $\overline{\mathbb{Q}_p}$ is not. The completion of $\overline{\mathbb{Q}_p}$ with respect to $v$ is denoted by $\mathbb{C}_p$. 

The $m$ extensions of the $p$-adic valuation on $\mathbb{Q}$ to $K$ are just multiples of the $\mathfrak{p}_i$-adic valuation on $K$:
\[\ord_p(x) = \frac{1}{e_i}\ord_{\mathfrak{p}_i}(x) \quad \text{ for } i = 1, \dots, m.\]
We also view these extensions as arising from various embeddings of $K$ into $\overline{\mathbb{Q}_p}$. Indeed, the extension to $\mathbb{Q}_p(\theta_i^{(j)})$ of the $p$-adic valuation on $\mathbb{Q}_p$ induces a $p$-adic valuation on $K$ via the embedding $\sigma_{ij}$ as 
\[v(x) = |N_{K_{\mathfrak{p}_i}/\mathbb{Q}_p}(\sigma_{ij}(x))|^{1/n_i}.\]
Here, as before, $n_i = \deg g_i(t) = [K_{\mathfrak{p}_i} : \mathbb{Q}_p]$. Furthermore, 
\[\ord_p(x) = \ord_p(\sigma_{ij}(x)),\]
and we have
\[\ord_p(\sigma_{ij}(x)) =  \frac{1}{e_i}\ord_{\mathfrak{p}_i}(x) \quad \text{ for } i = 1, \dots, m,\ j = 1, \dots, n_i.\]

Of course, in the special case $x \in \mathbb{Q}_p$, we can write
\[x = \sum_{i=k}^{\infty} u_ip^i\]
where $k = \ord_p(x)$ and the $p$-adic digits $u_i$ are in $\{0, \dots, p-1\}$ with $u_k \neq 0$. If $\ord_p(x) \geq 0$ then $x$ is called a $p$-adic \textit{integer}. The set of $p$-adic integers is denoted $\mathbb{Z}_p$. A $p$-adic \textit{unit} is an $x \in \mathbb{Q}_p$ with $\ord_p(x) = 0$. For any $p$-adic integer $\alpha$ and $\mu \in \mathbb{N}_0$ there exists a unique rational integer $x^{(\mu)} = \sum_{i=0}^{\mu-1}u_ip^i$ such that 
\[\ord_p(x-x^{(\mu)}) \geq \mu, \quad \text{ and } \quad 0 \leq x^{(\mu)} \leq p^{\mu} - 1.\]
For $\ord_p(x) \geq k$ we also write $x \equiv 0 \mod{p^k}$.

%--------------------------------------------------------------------------------------------------------------------------------------------%
%--------------------------------------------------------------------------------------------------------------------------------------------%

\section{$p$-adic logarithms}
\label{sec:pAdicLogarithms}

We have seen how to define $\ord_{\mathfrak{p}}$ and $\ord_p$ on algebraic extensions of $\mathbb{Q}$. For any $z \in \mathbb{C}_p$ with $\ord_p(z-1) > 0$, we can also define the $p$-adic logarithm of $z$ by
\[\log_p(z) = -\sum_{i=1}^{\infty} \frac{(1-z)^i}{i}.\]
By the $n^{\text{th}}$ term test, this series converges precisely in the region where ${\ord_p(z-1) > 0}$. Three important properties of the $p$-adic logarithm are
\begin{enumerate}
\item $\log_p(xy) = \log_p(x) + \log_p(y)$ whenever $\ord_p(x-1) > 0$ and $\ord_p(y-1) > 0$.
\item $\log_p(z^k) = k \log(p)$ whenever $\ord_p(z-1) > 0$ and $k \in \mathbb{Z}$. 
\item $\ord_p(\log_p(z)) = \ord_p(z-1)$ whenever $\ord_p(z-1) > 1/(p-1)$.
\end{enumerate}
Proofs of the first and last property can be found in \edit{ [Ha] (pp. 264-265)}. The second property follows from the first.

We will use the following lemma to extend the definition of the $p$-adic logarithm to all $p$-adic units in $\overline{\mathbb{Q}_p}$. 
\begin{lemma} \label{lem: pAdicLogarithms}
Let $z$ be a $p$-adic unit belonging to a finite extensions $L$ of $\mathbb{Q}_p$. Let $e$ and $f$ be the ramification index and inertial degree of $L$. 
\begin{enumerate}[(a)]
\item There is a positive integer $r$ such that $\ord_p(z^r-1) >0$.
\item If $r$ is the smallest positive integer having $\ord_p(z^r-1) >0$, then $r$ divides $p^f-1$, and an integer $q$ satisfies $\ord_p(z^q-1) >0$ if and only if it is a multiple of $r$.
\item If $r$ is a nonzero integer with $\ord_p(z^r-1) >0$, and if $k$ is an integer with $p^k(p-1) > e$, then
\[\ord_p(z^{rp^k}-1) >\frac{1}{p-1}.\]
\end{enumerate}
\end{lemma}
\edit{proofs and what e,f are?}

For $z$ a $p$-adic unit in $\overline{\mathbb{Q}_p}$ we define
\[\log_p{z} = \frac{1}{q}\log_p{z^q},\]
where $q$ is an arbitrary non-zero integer such that $\ord_p(z^q-1) >0$. To see that this definition is independent of $q$, let $r$ be the smallest positive integer with $\ord_p(z^r-1) >0$, note that $q/r$ is an integer, and use the second property of $p$-adic logarithms above to write
\[\frac{1}{q}\log_p{z^q} = \frac{1}{r(q/r)}\log_p{z^{r(q/r)}} = \frac{1}{r}\log_p{z^r}.\]
Choosing $q$ such that $\ord_p(z^q-1) > 1/(p-1)$ helps to speed up and control the convergence of the series defining $\log_p$ \edit{references here}.

It is straightforward to see that Properties 1 and 2 above extend to the case where $x,y,z$ are $p$-adic units. Combining this with Property 3, we obtain
\begin{lemma}\label{lem:pAdicLogarithms2}
Let $z_1, \dots, z_m \in \overline{\mathbb{Q}_p}$ be $p$-adic units and let $b_1, \dots, b_m \in \mathbb{Z}$. If 
\[\ord_p(z_1^{b_1}\cdots z_m^{b_m} - 1) > \frac{1}{p-1}\]
then 
\[\ord_p(b_1\log_p{z_1} + \cdots + b_m \log_p{z_m}) = \ord_p(z_1^{b_1}\cdots z_m^{b_m} - 1).\]
\end{lemma}

%--------------------------------------------------------------------------------------------------------------------------------------------%
%--------------------------------------------------------------------------------------------------------------------------------------------%

\section{The Weil height}
\label{sec:WeilHeight}

Let $K$ be a number field and at each place $v$ of $K$, let $K_v$ denote the completion of $K$ at $v$. Then
\[\sum_{v|p} [K_v:\mathbb{Q}_v] = [K:\mathbb{Q}]\]
for all places $p$ of $\mathbb{Q}$. We will use two absolute values $| \cdot |_v$ and $\| \cdot \|_v$ on $K$ which we now define. If $v|\infty$, then $\| \cdot \|_v$ restricted to $\mathbb{Q}$ is the usual Archimedean absolute value; if $v|p$ for a rational prime $p$, then $\| \cdot \|_v$ restricted to $\mathbb{Q}$ is the usual $p$-adic valuation. We then set
\[ | \cdot |_v = \| \cdot \|_v^{[K_v:\mathbb{Q}_v]/[K:\mathbb{Q}]}.\]
Let $x \in K$ and let $\log^+(\cdot)$ denote the real-valued function $\max\{\log(\cdot),0\}$ on $\mathbb{R}_{\geq 0}$. We define the \textit{logarithmic Weil height} $h(x)$ by 
\[h(x) = \frac{1}{[K:\mathbb{Q}]}\sum_v \log^+|x|_v,\]
where the sum is take over all places $v$ of $K$. If $x$ is an algebraic unit, then $|x|_v = 1$ for all non-Archimedean places $v$, and therefore $h(x)$ can be taken over the Archimedean places only. 
In particular, if $x \in \mathbb{Q}$, then with $x = p/q$ for $p,q \in \mathbb{Z}$ with $\gcd(p,q) = 1$, we have $h(x) = \log\max\{|p|,|q|\}$, and if $x \in \mathbb{Z}$ then $h(x) = \log|x|$. 

%--------------------------------------------------------------------------------------------------------------------------------------------%
%--------------------------------------------------------------------------------------------------------------------------------------------%

\section{Elliptic curves}
\label{sec:EllipticCurves}

Let $K$ be a field of characteristic $\text{char}(K) \neq 2,3$. An \textit{elliptic curve} $E$ over $K$ is a nonsingular curve of the form 
\begin{equation} \label{eq:EllipticCurve}
E: y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6
\end{equation}
with $a_i \in K$ having a specified base point, $\mathcal{O}\in E$. An equation of the form (\ref{eq:EllipticCurve}) is called a \textit{Weierstrass equation}. This equation is unique up to a coordinate transformation of the form
\[x = u^2x' + r, \quad\quad y = u^3y' + su^2x' + t, \]
with $r,s,t,u \in K, u\neq 0$. 
Applying several linear changes of variables and writing 
\[b_2 = a_1^2 + 4a_2, \quad b_4 = a_1a_3 + 2a_4, \quad b_6 = a_3^2 + 4a_6,\]
\[b_8 = a_1^2a_6 + 4a_2a_6 - a_1a_3a_4 + a_2a_3^2 - a_4^2,\]
\[ c_4 = b_2^2 - 24b_4, \quad \text{ and } \quad c_6 = -b_2^3 + 36b_2b_4 + 9b_2b_4b_6,\]
$E$ can be written as
\[E: y^2 = x^3 - 27c_4x - 54c_6.\]
Associated to this curve are the quantities 
\[\Delta = -b_2^2b_8 - 8b_4^3 - 27b_6^2 + 9b_2b_4b_6 \quad \text{ and } \quad j = c_4^3/\Delta,\]
where $\Delta$ is called the \textit{discriminant} of the Weierstrass equation and the quantity $j$ is called the \textit{j-invariant} of the elliptic curve. The condition of being nonsingular is equivalent to $\Delta$ being non-zero. Two elliptic curves are isomorphic over $\bar{K}$, the algebraic closure of $K$, if and only if they both have the same $j$-invariant.

When $K = \mathbb{Q}$, the Weierstrass model (\ref{eq:EllipticCurve}) can be chosen so that $\Delta$ has minimal $p$-adic order for each rational prime $p$ and $a_i \in \mathbb{Z}$. Suppose (\ref{eq:EllipticCurve}) is such a global minimal model for an elliptic curve $E$ over $\mathbb{Q}$. Reducing the coefficients modulo a rational prime $p$ yields a (possibly singular) curve over $\mathbb{F}_p$
\begin{equation}
\tilde{E}: y^2 + \tilde{a_1}xy + \tilde{a_3}y = x^3 + \tilde{a_2}x^2 + \tilde{a_4}x + \tilde{a_6},
\end{equation}
where $\tilde{a_i} \in \mathbb{F}_p$. This ``reduced" curve $\tilde{E}/\mathbb{F}_p$ is called the \textit{reduction of $E$ modulo} $p$. It is nonsingular provided that $\Delta \not \equiv 0 \mod{p}$, in which case it is an elliptic curve defined over $\mathbb{F}_p$. The curve $E$ is said to have \textit{good reduction} modulo $p$ if $\tilde{E}/\mathbb{F}_p$ is nonsingular, otherwise, we say $E$ has \textit{bad reduction} modulo $p$. 

The reduction type of $E$ at a rational prime $p$ is measured by the \textit{conductor}, 
\[N = \prod_{p}p^{f_p}\]
where the product runs over all primes $p$ and $f_p = 0$ for all but finitely many primes. In particular, $f_p \neq 0$ if $p$ does not divide $\Delta$. Equivalently, $E$ has bad reduction at $p$ if and only if $p \mid N$. Suppose $E$ has bad reduction at $p$ so that $f_p \neq 0$. The reduction type of $E$ at $p$ is said to be \textit{multiplicative} ($E$ has a node over $\mathbb{F}_p$) or \textit{additive} ($E$ has a cusp over $\mathbb{R}_p$) depending on whether $f_p = 1$ or $f_p \geq 2$, respectively. The $f_p$, hence the conductor, are invariant under isogeny. 

%--------------------------------------------------------------------------------------------------------------------------------------------%
%--------------------------------------------------------------------------------------------------------------------------------------------%

\section{Cubic forms}
\label{sec:CubicForms}

Let $a,b,c$ and $d$ be integers and consider the binary cubic form
\[F(x,y) = ax^3 + bx^2y + cxy^2 + dy^3.\]
Two such forms $F_1$ and $F_2$ are called \textit{equivalent} if they are equivalent under the $GL_{2}(\mathbb{Z})$-action. That is, if there exist integers $a_1, a_2, a_3$, and $a_4$ such that 
\[F_1(a_1x + a_2y, a_3x + a_4y) = F_2(x,y)\]
for all $x,y$, where $a_1a_4 - a_2a_3 = \pm 1$. In this case, we write $F_1 \sim F_2$. The \textit{discriminant} $D_F$ of such a form is given by 
\[D_F = -27a^2d^2 + b^2c^2 + 18abcd - 4ac^3 - 4b^3d = a^4 \prod_{i < j} (\alpha_i - \alpha_j)^2,\]
where $\alpha_1, \alpha_2$ and $\alpha_3$ are the roots of the polynomial $F(x,1)$. We observe that if $F_1 \sim F_2$, then $D_{F_1} = D_{F_2}$. 

Associated to $F$ is the Hessian $H_F(x,y)$, given by
\begin{align*}
H_F(x,y) & = -\frac{1}{4}\left( \frac{\partial^2F}{\partial x^2} \frac{\partial^2F}{\partial y^2} - \left(\frac{\partial^2F}{\partial x \partial y}\right)^2\right)\\
& = (b^2 - 3ac)x^2 + (bc - 9ad)xy + (c^2 - 3bd)y^2,
\end{align*}
and the Jacobian determinant of $F$ and $H_F$, a cubic form $G_F(x,y)$ defined by
\begin{align*}
G_F(x,y) &= \frac{\partial F}{\partial x} \frac{\partial H_F}{\partial y} - \frac{\partial F}{\partial y} \frac{\partial H_F}{\partial x} \\
& =  (-27a^2d + 9abc -2b^3)x^3 + (-3b^2c - 27abd + 18ac^2)x^2y +  \\
& \quad \quad + (3bc^2 - 18b^2d + 27acd)xy^2 + (-9bcd + 2c^3 + 27ad^2)y^3.
\end{align*}

%--------------------------------------------------------------------------------------------------------------------------------------------%
%--------------------------------------------------------------------------------------------------------------------------------------------%

\section{Lattices}
\label{sec:Lattices}

An $n$-dimensional lattice is a discrete subgroup of $\mathbb{R}^n$ of the form
\[\Gamma = \left\{ \sum_{i=1}^n x_i \mathbf{c}_i \ : \ x_i \in \mathbb{Z} \right\},\]
where $\mathbf{c}_1, \dots, \mathbf{c_n}$ are vectors forming a basis for $\mathbb{R}^n$. We say that the vectors $\mathbf{c}_1, \dots, \mathbf{c_n}$ form a \textit{basis} for $\Gamma$, or that they generate $\Gamma$. Let $B$ denote the matrix whose columns are the vectors $\mathbf{c}_1, \dots, \mathbf{c_n}$. Any lattice element $\mathbf{v}$ may be expressed as $\mathbf{v} = B\mathbf{x}$ for some $\mathbf{x} \in \mathbb{Z}^n$. 

A \textit{bilinear form} on a lattice $\Gamma$ is a function $\Phi: \Gamma \times \Gamma \to \mathbb{Z}$ satisying
\begin{enumerate}
\item $\Phi(\mathbf{u}, \mathbf{v}+\mathbf{w}) = \Phi(\mathbf{u},\mathbf{v}) + \Phi(\mathbf{u},\mathbf{w})$
\item $\Phi(\mathbf{u}+\mathbf{v}, \mathbf{w}) = \Phi(\mathbf{u},\mathbf{w}) + \Phi(\mathbf{v},\mathbf{w})$
\item $\Phi(a\mathbf{u}, \mathbf{w}) = a\Phi(\mathbf{u},\mathbf{w})$
\item $\Phi(\mathbf{u}, a\mathbf{w}) = a\Phi(\mathbf{u},\mathbf{w})$
\end{enumerate}
for all $\mathbf{u}, \mathbf{v}$, and $\mathbf{w}$ in $\Gamma$ and any $a \in \mathbb{R}$. 

In particular, given a basis we can define a specific bilinear form on our lattice $\Gamma$ as part of its structure. In the case of integral lattices, we have $\Phi: \Gamma \times \Gamma \to \mathbb{Z}$. This form describes a kind of distance between elements $\mathbf{x}$ and $\mathbf{y}$ of the lattice defined by $\Phi(\mathbf{x},\mathbf{y})$. 

A \textit{quadratic form} is a homogeneous polynomial of degree $2$. A form $Q$ is called positive definite if $Q(\mathbf{x})$ is strictly positive for any nonzero $\mathbf{x}$. A lattice is called \textit{positive definite} if its quadratic form is positive definite. 

A bilinear form has an associated quadratic form $Q: \Gamma \to \mathbb{Z}$ which is simply defined by $Q(\mathbf{x}) = \Phi(\mathbf{x}, \mathbf{x})$. The bilinear forms (and their associated quadratic forms) that we will be using come from the usual inner product on vectors in $\mathbb{R}^n$, also known as the dot product $\mathbf{u}\cdot \mathbf{v}$ for $\mathbf{u},\mathbf{v} \in \Gamma$, and multiplication with the basis matrix for coordinate vectors. That is, if $\mathbf{u} = B\mathbf{x}$ and $\mathbf{v} = B\mathbf{y}$ for a basis $B$, we have $\Phi(\mathbf{x},\mathbf{y}) = \mathbf{x}^TB^TB\mathbf{y}$. 

If $\mathbf{v} = B\mathbf{x}$, the \textit{norm} of the vector $\mathbf{v} \in \Gamma$ is defined by the quadratic form. We will be using the inner product $\mathbf{v} \cdot \mathbf{v}$. The norm of the coordinate vector $\mathbf{x}$ is then 
\[\mathbf{v}^T\mathbf{v} = (B\mathbf{x})^T(B\mathbf{x}) = \mathbf{x}^TB^TB\mathbf{x}.\]
Notice that this is also $\mathbf{x}^TA\mathbf{x}$ where $B^TB = A$. Here, $A$ is an example of the Gram matrix of $\Gamma$. The \textit{Gram matrix} of a lattice with basis $B$ with respect to a bilinear form $\Phi$ is defined to be the matrix A with entries $a_{ij} = \Phi(\mathbf{b}_i,\mathbf{b}_j)$.

The bilinear form on L can be written with respect to either embedded or coordinate vectors. Using another basis to express the lattice elements is possible, and sometimes preferable. But the Gram matrix is specific to the bilinear form on the lattice, and should not change when operating on embedded vectors. If it is operating on coordinate vectors, the change of basis must be accounted for.

If $A$ and $B$ are invertible $n \times n$ real matrices, then the lattice generated by the columns of $A$ is equal to the lattice generated by the columns of $B$ if and only if there is a unimodular matrix $U$ such that $AU = B$. 



%--------------------------------------------------------------------------------------------------------------------------------------------%

\endinput

Any text after an \endinput is ignored.
You could put scraps here or things in progress.